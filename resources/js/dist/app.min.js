"use strict";var _axios=_interopRequireDefault(require("axios")),_noty=_interopRequireDefault(require("noty")),_admin=require("./admin"),_moment=_interopRequireDefault(require("moment")),_stripe=require("./stripe");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(r,!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var addToCart=document.querySelectorAll(".add-to-cart"),cartCounter=document.querySelector("#cartCounter");function updateCart(e){_axios.default.post("/update-cart",e).then(function(e){cartCounter.innerText=e.data.totalQty,new _noty.default({type:"success",timeout:1e3,text:"Item added to cart",progressBar:!1,layout:"topLeft"}).show()}).catch(function(e){new _noty.default({type:"error",timeout:1e3,text:"Something went wrong",progressBar:!1}).show()})}addToCart.forEach(function(t){t.addEventListener("click",function(e){updateCart(JSON.parse(t.dataset.pizza))})});var alertMsg=document.querySelector("#success-alert");alertMsg&&setTimeout(function(){alertMsg.remove()},2e3);var statuses=document.querySelectorAll(".status_line"),hiddenInput=document.querySelector("#hiddenInput"),order=hiddenInput?hiddenInput.value:null;order=JSON.parse(order);var time=document.createElement("small");function updateStatus(r){statuses.forEach(function(e){e.classList.remove("step-completed"),e.classList.remove("current")});var n=!0;statuses.forEach(function(e){var t=e.dataset.status;n&&e.classList.add("step-completed"),t==r.status&&(n=!1,time.innerText=(0,_moment.default)(r.updatedAt).format("hh:mm A"),e.appendChild(time),e.nextElementSibling&&e.nextElementSibling.classList.add("C"))})}updateStatus(order),(0,_stripe.initStripe)();var socket=io();(0,_admin.initAdmin)(socket),order&&socket.emit("join","order_".concat(order._id));var adminAreaPath=window.location.pathname;adminAreaPath.includes("admin")&&((0,_admin.initAdmin)(socket),socket.emit("join","adminRoom")),socket.on("orderUpdated",function(e){var t=_objectSpread({},order);t.updatedAt=(0,_moment.default)().format(),t.status=e.status,updateStatus(t),new _noty.default({type:"success",timeout:1e3,text:"Order updated",progressBar:!1}).show()});
//# sourceMappingURL=app.min.js.map
