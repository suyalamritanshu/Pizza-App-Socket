{"version":3,"sources":["admin.js"],"names":["_axios","_interopRequireDefault","require","_moment","_noty","initAdmin","socket","markup","orderTableBody","document","querySelector","orders","generateMarkup","renderItems","map","items","parsedItems","order","_id","then","Object","values","menuItem","concat","name","qty","join","customerId","address","status","createdAt","format","paymentStatus","axios","get","headers","X-Requested-With","res","innerHTML","err","console","log","on","Noty","type","timeout","text","progressBar","show","unshift"],"mappings":"gGAAA,IAAAA,OAAAC,uBAAAC,QAAA,UACAC,QAAAF,uBAAAC,QAAA,WACAE,MAAAH,uBAAAC,QAAA,iFAEQ,SAASG,UAAUC,GACvB,IALJC,EAKUC,EAAiBC,SAASC,cAAc,mBAC1CC,EAAS,GAyBb,SAASC,EAAeD,GATxB,OAASE,EAATC,IAAqBC,SAAAA,GACbC,MAAAA,gHAAAA,OACJC,EAAAC,IADIF,mCAAAA,OAZA,SAAAD,GAGLI,OAJUC,OAAAC,OAAAN,GAICD,IAAA,SAAAQ,GACJ,MAAA,wBAAAC,OACGX,EAAeD,KAAxBa,KADM,OAAAD,OACND,EAAAG,IADM,6BANVC,KASS,IAWNb,CAAAI,EAAAF,OANKC,gFAAAA,OAQwBC,EAAAU,WAAAH,KARxBR,wDAAAA,OASuBC,EAAAW,QATvBZ,0QAAAA,OAqB8DC,EAAMC,IArBpEF,4YAAAA,OAiEK,iBAAAC,EAAAY,OAAA,WAAA,GAjELb,sHAAAA,OAiEK,cAAAC,EAAAY,OAAA,WAAA,GAjELb,wHAAAA,OAiEJ,aAAAC,EAAAY,OAAA,WAAA,GAjEIb,wHAAAA,OAyEJ,cAAAC,EAAAY,OAAA,WAAA,GAzEIb,2JAAAA,OA6EX,cAAAC,EAAAY,OAAA,WAAA,GA7EWb,izBAAAA,QAkDW,EAAAb,QAAA,SAAOc,EAAMa,WAAWC,OAAO,WAlD1Cf,gGAAAA,OAqDWC,EAAMe,cAAgB,OAAS,WArD1ChB,0DAyDDU,KAAK,IA/EhBO,OAAAA,QAAAC,IAAA,gBAAA,CASQC,QAAS,CARjBC,mBAAA,oBAYOjB,KAAK,SAAAkB,GAVJ1B,EAASN,EAAUC,KACjBE,EAAAA,EAA0BE,GAC5BC,EAAJ2B,UAAA/B,IALJ,MAMI,SAAAgC,GAYIC,QAAQC,IAAIF,KAoEhBjC,EAAOoC,GAAG,cAAe,SAACzB,GACtB,IAAI0B,MAAAA,QAAK,CACLC,KAAM,UACNC,QAAS,IACTC,KAAM,YACNC,aAAa,IACdC,OAEHrC,EAAOsC,QAAQhC,GACfT,EAAe8B,UAAY,GAC3B9B,EAAe8B,UAAY1B,EAAeD","file":"admin.min.js","sourcesContent":["import axios from 'axios'\r\nimport moment from 'moment'\r\nimport Noty from 'noty'\r\n\r\n export function initAdmin(socket) {\r\n    const orderTableBody = document.querySelector('#orderTableBody')\r\n    let orders = []\r\n    let markup\r\n\r\n    axios.get('/admin/orders', {\r\n        headers: {\r\n            \"X-Requested-With\": \"XMLHttpRequest\"\r\n        }\r\n\r\n    }).then(res =>{\r\n        orders = res.data \r\n        markup = generateMarkup(orders)\r\n        orderTableBody.innerHTML = markup\r\n    }).catch(err =>{\r\n        console.log(err)\r\n    })\r\n\r\n    function renderItems(items) {\r\n        let parsedItems = Object.values(items)\r\n        return parsedItems.map((menuItem) => {\r\n            return `\r\n                <p>${ menuItem.item.name } - ${ menuItem.qty } pcs </p>\r\n            `\r\n        }).join('')\r\n      }\r\n\r\n    function generateMarkup(orders) {\r\n        return orders.map(order => {\r\n            return `\r\n                <tr>\r\n                <td class=\"border px-4 py-2 text-green-900\">\r\n                    <p>${ order._id }</p>\r\n                    <div>${ renderItems(order.items) }</div>\r\n                </td>\r\n                <td class=\"border px-4 py-2\">${ order.customerId.name }</td>\r\n                <td class=\"border px-4 py-2\">${ order.address }</td>\r\n                <td class=\"border px-4 py-2\">\r\n                    <div class=\"inline-block relative w-64\">\r\n                        <form action=\"/admin/order/status\" method=\"POST\">\r\n                            <input type=\"hidden\" name=\"orderId\" value=\"${ order._id }\">\r\n                            <select name=\"status\" onchange=\"this.form.submit()\"\r\n                                class=\"block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline\">\r\n                                <option value=\"order_placed\"\r\n                                    ${ order.status === 'order_placed' ? 'selected' : '' }>\r\n                                    Placed</option>\r\n                                <option value=\"confirmed\" ${ order.status === 'confirmed' ? 'selected' : '' }>\r\n                                    Confirmed</option>\r\n                                <option value=\"prepared\" ${ order.status === 'prepared' ? 'selected' : '' }>\r\n                                    Prepared</option>\r\n                                <option value=\"delivered\" ${ order.status === 'delivered' ? 'selected' : '' }>\r\n                                    Delivered\r\n                                </option>\r\n                                <option value=\"completed\" ${ order.status === 'completed' ? 'selected' : '' }>\r\n                                    Completed\r\n                                </option>\r\n                            </select>\r\n                        </form>\r\n                        <div\r\n                            class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\r\n                            <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\"\r\n                                viewBox=\"0 0 20 20\">\r\n                                <path\r\n                                    d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\" />\r\n                            </svg>\r\n                        </div>\r\n                    </div>\r\n                </td>\r\n                <td class=\"border px-4 py-2\">\r\n                    ${ moment(order.createdAt).format('hh:mm A') }\r\n                </td>\r\n                <td class=\"border px-4 py-2\">\r\n                    ${ order.paymentStatus ? 'paid' : 'Not paid' }\r\n                </td>\r\n            </tr>\r\n        `\r\n        }).join('')\r\n    }\r\n\r\n\r\n    //Socket \r\n   \r\n\r\n    socket.on('orderPlaced', (order) =>{\r\n        new Noty({\r\n            type: 'success',\r\n            timeout: 1000,\r\n            text: 'New Order',\r\n            progressBar: false,\r\n        }).show();\r\n\r\n        orders.unshift(order)\r\n        orderTableBody.innerHTML = ''\r\n        orderTableBody.innerHTML = generateMarkup(orders)\r\n\r\n    })\r\n}\r\n\r\n"]}