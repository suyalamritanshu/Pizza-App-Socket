"use strict";var LocalStrategy=require("passport-local").Strategy,User=require("../models/user"),bcrypt=require("bcrypt");function init(e){e.use(new LocalStrategy({usernameField:"email"},function(r,n,t){var s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(User.findOne({email:r}));case 2:if(s=e.sent){e.next=5;break}return e.abrupt("return",t(null,!1,{message:"No user with this email"}));case 5:bcrypt.compare(n,s.password).then(function(e){return e?t(null,s,{message:"Logged in succesfully"}):t(null,!1,{message:"Wrong username or password"})}).catch(function(e){return t(null,!1,{message:"Something went wrong"})});case 6:case"end":return e.stop()}})})),e.serializeUser(function(e,r){r(null,e._id)}),e.deserializeUser(function(e,n){User.findById(e,function(e,r){n(e,r)})})}module.exports=init;
//# sourceMappingURL=passport.min.js.map
