{"version":3,"sources":["cartController.js"],"names":["require","json","cartController","index","req","res","session","cart","items","totalPrice","body","_id","totalQty","qty","item","price"],"mappings":"0BAAiBA,QAAQ,WAAjBC,cAAAA,KAER,SAASC,iBAFDD,MAGG,CACHE,MADG,SACGC,EAAKC,GAFVH,EAAAA,OAAT,mBAEQC,OADG,SAAAC,EAAAC,GAYCD,EAAAE,QAAAC,OACAH,EAAAE,QAAAC,KAAA,CACAC,MAAA,GACSF,SAAc,EACPC,WAAO,IAGfE,IAAAA,EAAYL,EAAAE,QAAAC,KAeZ,OATJA,EAAKC,MAAMJ,EAAIM,KAAKC,KAKfC,EAALJ,MAAgBD,EAAKK,KAAAA,KAArBC,IAAAN,EAAAC,MAAAJ,EAAAM,KAAAC,KAAAE,IAAA,EARIN,EAAOD,MAAAA,EAAQC,KAEvBI,KAAA,CAGQG,KAAMV,EAAIM,KAFTF,IAAS,GAMTC,EAAAA,SAAkBA,EAAAA,SAAiBC,EACrCH,EAAAE,WAAAF,EAAAE,WAAAL,EAAAM,KAAAK,MAEEH,EAALX,KAAoB,CAACW,SAAWR,EAAhCE,QAAAC,KAAAK,aAGcA,OAAAA,QAAQV","file":"cartController.min.js","sourcesContent":["const { json } = require(\"express\")\r\n\r\nfunction cartController() {\r\n    return {\r\n        index(req, res) {\r\n            res.render('customers/cart')\r\n        },\r\n        update(req, res) {\r\n            // let cart = {\r\n            //     items: {\r\n            //         pizzaId: { item: pizzaObject, qty:0 },\r\n            //         pizzaId: { item: pizzaObject, qty:0 },\r\n            //         pizzaId: { item: pizzaObject, qty:0 },\r\n            //     },\r\n            //     totalQty: 0,\r\n            //     totalPrice: 0\r\n            // }\r\n            // for the first time creating cart and adding basic object structure\r\n            if (!req.session.cart) {\r\n                req.session.cart = {\r\n                    items: {},\r\n                    totalQty: 0,\r\n                    totalPrice: 0\r\n                }\r\n            }\r\n            let cart = req.session.cart\r\n\r\n            // Check if item does not exist in cart \r\n            if(!cart.items[req.body._id]) {\r\n                cart.items[req.body._id] = {\r\n                    item: req.body,\r\n                    qty: 1\r\n                }\r\n                cart.totalQty = cart.totalQty + 1\r\n                cart.totalPrice = cart.totalPrice + req.body.price\r\n            } else {\r\n                cart.items[req.body._id].qty = cart.items[req.body._id].qty + 1\r\n                cart.totalQty = cart.totalQty + 1\r\n                cart.totalPrice =  cart.totalPrice + req.body.price\r\n            }\r\n            return res.json({ totalQty: req.session.cart.totalQty })\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = cartController"]}