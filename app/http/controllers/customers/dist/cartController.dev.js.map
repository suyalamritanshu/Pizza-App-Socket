{"version":3,"sources":["cartController.js"],"names":["require","json","cartController","index","req","res","render","update","session","cart","items","totalQty","totalPrice","body","_id","item","qty","price","module","exports"],"mappings":";;eAAiBA,OAAO,CAAC,SAAD,C;IAAhBC,I,YAAAA,I;;AAER,SAASC,cAAT,GAA0B;AACtB,SAAO;AACHC,IAAAA,KADG,iBACGC,GADH,EACQC,GADR,EACa;AACZA,MAAAA,GAAG,CAACC,MAAJ,CAAW,gBAAX;AACH,KAHE;AAIHC,IAAAA,MAJG,kBAIIH,GAJJ,EAISC,GAJT,EAIc;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAI,CAACD,GAAG,CAACI,OAAJ,CAAYC,IAAjB,EAAuB;AACnBL,QAAAA,GAAG,CAACI,OAAJ,CAAYC,IAAZ,GAAmB;AACfC,UAAAA,KAAK,EAAE,EADQ;AAEfC,UAAAA,QAAQ,EAAE,CAFK;AAGfC,UAAAA,UAAU,EAAE;AAHG,SAAnB;AAKH;;AACD,UAAIH,IAAI,GAAGL,GAAG,CAACI,OAAJ,CAAYC,IAAvB,CAlBa,CAoBb;;AACA,UAAG,CAACA,IAAI,CAACC,KAAL,CAAWN,GAAG,CAACS,IAAJ,CAASC,GAApB,CAAJ,EAA8B;AAC1BL,QAAAA,IAAI,CAACC,KAAL,CAAWN,GAAG,CAACS,IAAJ,CAASC,GAApB,IAA2B;AACvBC,UAAAA,IAAI,EAAEX,GAAG,CAACS,IADa;AAEvBG,UAAAA,GAAG,EAAE;AAFkB,SAA3B;AAIAP,QAAAA,IAAI,CAACE,QAAL,GAAgBF,IAAI,CAACE,QAAL,GAAgB,CAAhC;AACAF,QAAAA,IAAI,CAACG,UAAL,GAAkBH,IAAI,CAACG,UAAL,GAAkBR,GAAG,CAACS,IAAJ,CAASI,KAA7C;AACH,OAPD,MAOO;AACHR,QAAAA,IAAI,CAACC,KAAL,CAAWN,GAAG,CAACS,IAAJ,CAASC,GAApB,EAAyBE,GAAzB,GAA+BP,IAAI,CAACC,KAAL,CAAWN,GAAG,CAACS,IAAJ,CAASC,GAApB,EAAyBE,GAAzB,GAA+B,CAA9D;AACAP,QAAAA,IAAI,CAACE,QAAL,GAAgBF,IAAI,CAACE,QAAL,GAAgB,CAAhC;AACAF,QAAAA,IAAI,CAACG,UAAL,GAAmBH,IAAI,CAACG,UAAL,GAAkBR,GAAG,CAACS,IAAJ,CAASI,KAA9C;AACH;;AACD,aAAOZ,GAAG,CAACJ,IAAJ,CAAS;AAAEU,QAAAA,QAAQ,EAAEP,GAAG,CAACI,OAAJ,CAAYC,IAAZ,CAAiBE;AAA7B,OAAT,CAAP;AACH;AAtCE,GAAP;AAwCH;;AAEDO,MAAM,CAACC,OAAP,GAAiBjB,cAAjB","sourcesContent":["const { json } = require(\"express\")\r\n\r\nfunction cartController() {\r\n    return {\r\n        index(req, res) {\r\n            res.render('customers/cart')\r\n        },\r\n        update(req, res) {\r\n            // let cart = {\r\n            //     items: {\r\n            //         pizzaId: { item: pizzaObject, qty:0 },\r\n            //         pizzaId: { item: pizzaObject, qty:0 },\r\n            //         pizzaId: { item: pizzaObject, qty:0 },\r\n            //     },\r\n            //     totalQty: 0,\r\n            //     totalPrice: 0\r\n            // }\r\n            // for the first time creating cart and adding basic object structure\r\n            if (!req.session.cart) {\r\n                req.session.cart = {\r\n                    items: {},\r\n                    totalQty: 0,\r\n                    totalPrice: 0\r\n                }\r\n            }\r\n            let cart = req.session.cart\r\n\r\n            // Check if item does not exist in cart \r\n            if(!cart.items[req.body._id]) {\r\n                cart.items[req.body._id] = {\r\n                    item: req.body,\r\n                    qty: 1\r\n                }\r\n                cart.totalQty = cart.totalQty + 1\r\n                cart.totalPrice = cart.totalPrice + req.body.price\r\n            } else {\r\n                cart.items[req.body._id].qty = cart.items[req.body._id].qty + 1\r\n                cart.totalQty = cart.totalQty + 1\r\n                cart.totalPrice =  cart.totalPrice + req.body.price\r\n            }\r\n            return res.json({ totalQty: req.session.cart.totalQty })\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = cartController"],"file":"cartController.dev.js"}